<launch>

    <arg name="x" default="0" />
    <arg name="y" default="0" />
    <arg name="z" default="0" />
    <arg name="R" default="0" />
    <arg name="P" default="0" />
    <arg name="Y" default="0" />

    <arg name="run_px4" default="true"/>
    
    <!-- vehcile model and config -->
    <arg name="est" default="ekf2" />
    <arg name="vehicle" default="uuv_hippocampus" />
    <arg name="ID" default="0" />
    <env name="PX4_SIM_MODEL" value="$(arg vehicle)"/>
    <env name="PX4_ESTIMATOR" value="$(arg est)"/>
    <arg name="mavlink_udp_port" default="$(eval 14560 + arg('ID'))" />
    <arg name="mavlink_tcp_port" default="$(eval 4560 + arg('ID'))" />

    <!-- PX4 configs -->
    <arg name="interactive" default="true"/>

    <!-- PX4 SITL -->
    <arg unless="$(arg interactive)" name="px4_command_arg1" value="-d" />
    <arg if="$(arg interactive)" name="px4_command_arg1" value="" />
    <node if="$(arg run_px4)" name="sitl_$(arg ID)" pkg="px4" type="px4" output="screen" args="$(find px4)/ROMFS/px4fmu_common -s etc/init.d-posix/rcS -i $(arg ID) -w sitl_$(arg vehicle)_$(arg ID) $(arg px4_command_arg1)"></node>

    <!-- Vehicle URDF file -->
    <param name="robot_description" command="xacro '$(find hippocampus_sim)/urdf/uuv_hippocampus.xacro' ID:=$(arg ID) mavlink_udp_port:=$(arg mavlink_udp_port) mavlink_tcp_port:=$(arg mavlink_tcp_port)"/>

    <!-- spawn vehicle -->
    <arg name="model_name" default="$(arg vehicle)_$(arg ID)"/>
    <node name="mybot_spawn" pkg="gazebo_ros" type="spawn_model" output="screen"
    args="-urdf -param robot_description -model $(arg model_name)
          -x $(arg x) -y $(arg y) -z $(arg z)
          -R $(arg R) -P $(arg P) -Y $(arg Y)"/>
</launch>
